<!DOCTYPE html>
<html>
  <head>
    <title>{{title}}</title>
    <!-- <link rel='stylesheet' href='/stylesheets/style.css' /> -->
    <!-- Main Quill library -->
    <script src="//cdn.quilljs.com/1.0.0/quill.js"></script>
    <script src="//cdn.quilljs.com/1.0.0/quill.min.js"></script>

    <!-- Theme included stylesheets -->
    <link href="//cdn.quilljs.com/1.0.0/quill.snow.css" rel="stylesheet">
    <link href="//cdn.quilljs.com/1.0.0/quill.bubble.css" rel="stylesheet">

    <!-- Core build with no theme, formatting, non-essential modules -->
    <link href="//cdn.quilljs.com/1.0.0/quill.core.css" rel="stylesheet">
    <script src="//cdn.quilljs.com/1.0.0/quill.core.js"></script>
    <!-- Include Quill stylesheet -->
    <link href="https://cdn.quilljs.com/1.0.0/quill.snow.css" rel="stylesheet">

    <!-- Include the Quill library -->
    <script src="https://cdn.quilljs.com/1.0.0/quill.js"></script>
  </head>
  <body>
    <a href="/users/dashboard">Home</a>    <!-- Create the toolbar container -->

    Title:<br/>
    <input type="text" name="title" id="title">
    <div id="toolbar">
      <button class="ql-bold">Bold</button>
      <button class="ql-italic">Italic</button>
    </div>
    
    <!-- Create the editor container -->
    <div id="editor">
      <p>{{ocr}}</p>
    </div>
    <!-- Initialize Quill editor -->
    <button type="button" onclick="proceed();">Save</button> 
    <script>
      var editor = new Quill('#editor', {
        modules: { toolbar: '#toolbar' },
        theme: 'snow'
      });
      
      // {{#if doc}}
      //   var a = {{doc}}
      //   editor.setContents(a)
      // {{/if}}
      
      function proceed () {
        var delta = {
          "title": document.getElementById("title").value, 
          "content":editor.getContents()
        }
        var xhr = new XMLHttpRequest();
        xhr.open("POST", '/edit/new', true);
        xhr.setRequestHeader('Content-Type', 'application/JSON');
        xhr.send(JSON.stringify(delta));
      }

      // editor.on('text-change', function(delta, oldDelta, source) {
      //    if (source == 'api') {
      //     console.log("An API call triggered this change.");
      //   } else if (source == 'user') {
      //     console.log("A user action triggered this change.");
      //     var delta = editor.getContents()
      //     var xhr = new XMLHttpRequest();
      //     xhr.open("POST", '/edit', true);
      //     xhr.setRequestHeader('Content-Type', 'application/JSON');
      //     xhr.send(JSON.stringify(delta));
      //   }
      // });

      // var delta = editor.getContents()
      // document.write(JSON.stringify(delta.ops))
      // var text = editor.getText()
      // document.write(text)

      // var xhr = new XMLHttpRequest();
      // xhr.open("POST", '/edit', true);
      // xhr.setRequestHeader('Content-Type', 'application/JSON');
      // xhr.send(JSON.stringify(delta));
    </script>
  </body>
</html>
